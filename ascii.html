<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>15x15 Square Table</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>
  <body
    class="bg-slate-950 text-slate-100 min-h-[100dvh] h-[100dvh] flex items-center justify-center p-1 sm:p-4"
  >
    <main class="w-full h-full max-w-none flex flex-col">
      <header class="mb-3 flex items-center justify-between gap-4 shrink-0">
        <div>
          <h1 class="text-lg font-semibold">15Ã—15 Table</h1>
          <p class="text-sm text-slate-300">
            Maintains a 1:1 square ratio as you resize the window.
          </p>
        </div>
        <button
          id="toggleGrid"
          class="px-3 py-2 bg-slate-800 hover:bg-slate-700 active:bg-slate-600 text-sm rounded-md"
        >
          Toggle Lines
        </button>
      </header>

      <section
        class="aspect-square bg-slate-900/40 border border-slate-800 mx-auto w-[min(calc(100dvh-120px),calc(100vw-0.5rem))] h-[min(calc(100dvh-120px),calc(100vw-0.5rem))]"
      >
        <div
          id="grid"
          class="w-full h-full grid overflow-hidden select-none"
        ></div>
      </section>

      <footer class="mt-3 text-xs text-slate-400 shrink-0">
        Tip: Click a cell to toggle highlight.
      </footer>
    </main>

    <script>
      const grid = document.getElementById("grid");
      const toggleGridBtn = document.getElementById("toggleGrid");

      const SIZE = 15;

      // Configure CSS grid sizing without a stylesheet.
      grid.style.gridTemplateColumns = `repeat(${SIZE}, minmax(0, 1fr))`;
      grid.style.gridTemplateRows = `repeat(${SIZE}, minmax(0, 1fr))`;

      // Toggle lines by toggling a single class on the grid container.
      // (Arbitrary selector variant is supported by Tailwind CDN runtime.)
      const LINES_CLASS =
        "[&>div]:shadow-[inset_0_0_0_0.5px_rgba(148,163,184,0.9)]";

      function updateCellFontSize() {
        const rect = grid.getBoundingClientRect();
        const cell = Math.min(rect.width, rect.height) / SIZE;
        const px = Math.max(10, Math.min(26, cell * 0.62));
        grid.style.setProperty("--cell-font", px + "px");
      }

      function buildGrid() {
        const frag = document.createDocumentFragment();
        for (let r = 0; r < SIZE; r++) {
          for (let c = 0; c < SIZE; c++) {
            const el = document.createElement("div");
            el.dataset.cell = "1";
            el.dataset.r = r;
            el.dataset.c = c;

            const isEdge =
              r === 0 || c === 0 || r === SIZE - 1 || c === SIZE - 1;

            el.className = [
              "bg-slate-950/20",
              "transition-colors",
              "cursor-pointer",
              "flex",
              "items-center",
              "justify-center",
              "leading-none",
              "text-slate-300",
              isEdge
                ? "text-slate-200 drop-shadow-[0_1px_0_rgba(0,0,0,0.35)]"
                : "",
            ]
              .filter(Boolean)
              .join(" ");

            if (isEdge) {
              el.textContent = "#";
              // Bigger wall glyph (matches the maze version's wall sizing)
              el.style.fontSize = "calc(var(--cell-font, 14px) * 1.35)";
              el.style.lineHeight = "1";
            } else {
              el.textContent = "";
              el.style.fontSize = "var(--cell-font, 14px)";
              el.style.lineHeight = "";
            }

            frag.appendChild(el);
          }
        }
        grid.replaceChildren(frag);
      }

      // Event delegation: one listener for the whole grid.
      grid.addEventListener("click", (e) => {
        const cell = e.target.closest('[data-cell="1"]');
        if (!cell || !grid.contains(cell)) return;
        cell.classList.toggle("bg-emerald-500/25");
        cell.classList.toggle("text-emerald-200");
      });

      let linesOn = true;
      function setLines(on) {
        linesOn = on;
        grid.classList.toggle(LINES_CLASS, on);
        toggleGridBtn.textContent = on ? "Hide Lines" : "Show Lines";
      }

      toggleGridBtn.addEventListener("click", () => setLines(!linesOn));

      buildGrid();
      setLines(true);

      updateCellFontSize();
      window.addEventListener(
        "resize",
        () => {
          updateCellFontSize();
          // Re-apply edge sizing after resize so wall glyphs stay scaled.
          // (fontSize uses CSS var; this is mostly to keep behavior consistent.)
        },
        { passive: true }
      );
    </script>
  </body>
</html>
